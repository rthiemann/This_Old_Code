PROCEDURE INTERPOLATE (THE_ONE_WE_WANT, FOUND).
/* THIS PROCEDURE IS WRITTEN FOR A FILE (OF AT LEAST 2 RECORDS)
   WITH EVENLY DISTRIBUTED VALUES BETWEEN 1 AND 2000. */

DEFINE FUNCTION INTERP_FCN (LO, THIS, HI)
                  = (THIS - LO + 1) / (HI - LO + 1).
/* RETURNS THE PERCENT (IN DECIMAL FORM) OF THE DISTANCE
   THROUGH THE SECTION WHERE THIS RECORD SHOULD BE. */
END_FUNCTION.

FOUND = FALSE.
DONE = FALSE.

/* INITIALIZE SECTION BOUNDARIES */
LOWER = 1.
UPPER = LAST_RECORD_IN_FILE.
LO_VALUE = 1.
HI_VALUE = 2000 .

WHILE NOT DONE DO
   SECTION_SIZE = UPPER - LOWER + 1.
   PERCENT = INTERP_FCN (LO_VALUE, THE_ONE_WE_WANT, HI_VALUE).
   RECORD_NUMBER = LOWER + INTEGER (PERCENT * SECTION_SIZE) - 1.
   IF RECORD_NUMBER < LOWER -
      THEN RECORD_NUMBER = LOWER.
   READ RECORD RECORD_NUMBER.

   IF RECORD = THE_ONE_WE_WANT
      THEN DO
         FOUND = TRUE.
         DONE = TRUE.

   ELSE IF SECTION_SIZE < 2
      THEN DONE = TRUE.   /* THE_ONE_WE_WANT IS NOT IN THE FILE */

   /* ELSE RESET SECTION BOUNDARIES AND PREPARE TO TRY AGAIN */
   ELSE IF RECORD < THE_ONE_WE_WANT
      THEN DO
         LOWER = RECORD_NUMBER.
         LO_VALUE = RECORD.   /* THIS RECORD *I/
      ELSE DO
        UPPER = RECORD_NUMBER.
        HI_VALUE = RECORD.   /* THIS RECORD */
    END IF.

  END_WHILE.

END INTERPOLATE.

